Using BayesSPM to conduct Statistical parametric mapping of
bio-mechanical data with Bayesian inference
================
Linda Amoafo
3/14/23

## Introduction

Statistical Parametric Mapping (SPM) was designed for statistical
inference on dependent variables sampled from a large number of
spatially correlated voxels (volume elements) (Friston 2007). The
biomechanics research community has expressed a keen interest in recent
advancements in Statistical Parametric Mapping (SPM) for continuum data,
such as kinematic time series. The introduction of SPM into
biomechanical literature was facilitated by T. Pataky’s Python/MATLAB
package, (Pataky), which was originally adapted from neuroimaging. The
package allows frequentist statistical analyses that are commonly used
in biomechanics. The BayesSPM package proposes the use of Bayesian
analogs of SPM, which are based on Bayes factors and posterior
probability with default priors, using the BayesFactor package in R. The
package presents results for t test (two-sample and paired sample
t-tests) as well ANOVA (for multiple group testing). This vignette is
motivated by works from

# Classical SPM

To prevent an inflation of Type I error, Statistical Parametric Mapping
(SPM) uses Random Field Theory (RFT) instead of conducting separate
inferential tests at each time point. RFT makes use of smoothness, which
refers to the local correlation between adjacent time points, to address
the multiple testing problem. This approach provides accurate control of
Type I errors, regardless of the sampling rate, when testing correlated
field data. In the context of biomechanics, biological processes are
typically smooth, and the data acquired usually samples above the
Nyquist criterion. As such, neighboring time samples are not
independent, and this needs to be considered (Pataky 2010). Instead of
computing a p-value at each time sample, RFT calculates a p-value for
clusters of statistics (e.g., t) that cross a critical threshold (t\*).
The rationale behind RFT is that the height and width of suprathreshold
clusters generated by smooth random fields are inversely proportional to
their probability of occurrence. Therefore, a large suprathreshold
cluster is the topological equivalent of a large t-value for 0D data.

The critical thresholds for Statistical Parametric Mapping (SPM) are
typically calculated using a Type I error of α = 0.05. As a result, when
the observed test-statistic time series crosses the threshold, the
cluster has a p-value less than 0.05. This enables the researcher to
reject the null hypothesis ($H_0$) that there is no difference between
the two time series.

# BAYESIAN INFERENCE

The SPM p-values represent the probability of the observed data given
that the null hypothesis $(H_0)$ is true, i.e., $P(data | H_0)$, without
considering any alternative hypothesis $(H_1)$. However, most
researchers would want to know, the probability that $(H_0)$ or $(H_1)$
are good descriptions of the data, ie. $P(H_0 | data), P(H_1 | data)$.
Additionally, frequentist inference is asymmetric in the sense that, it
is only possible to state evidence against $H_0$ and not evidence in
favor of $H_0$ or in favor of any alternative $H_1$.

Bayesian inference allows for statements regarding evidence in favor of
the null hypothesis $(H_0)$ or any alternative hypothesis $(H1)$. For
example, in a study aimed at demonstrating that gait kinematic time
series are left-right symmetric, Bayesian inference can provide
quantification of the evidence in favor of
$H_0: μ_{left}(t) = μ_{right}(t)$. This is possible due to the
incorporation of prior knowledge into the analysis, which allows for the
calculation of the probability of both $H_0$ and $H_1$ being true.

## Bayesian SPM Posterior Probabilty Maps

In this package, we rely on the Bayes factor as an approach to producing
SPM posterior probability maps at each voxel/ time point.

## Posterior Probability Threshold

Users are allowed to set a posterior probability to control for false
discovery rate of their choice. This posterior probability serve as the
analogous supra-cluster threshold in the frequentist setting. eg, set
posterior probability of 0.95 to control for a 5% false discovery rate,
equivalent to $\alpha=0.05$.

## Q-value Threshold (Less conservative threshold)

You can add options to executable code like this

    [1] 4

The `echo: false` option disables the printing of code (only output is
displayed).

<div id="refs" class="references csl-bib-body hanging-indent">

<div id="ref-friston2007short" class="csl-entry">

Friston, Karl. 2007. “A Short History of SPM.” *Statistical Parametrical
Mapping: The Analysis of Functional Brain Images*, 3–9.

</div>

<div id="ref-spm1d" class="csl-entry">

Pataky, T. “<span class="nocase">one-dimensional Statistical Parametric
Mapping</span>.” <https://spm1d.org/#/>.

</div>

</div>
